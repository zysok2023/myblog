# 网络抓包
tcpdump 和 Wireshark 就是最常用的网络抓包和分析工具，更是分析网络性能必不可少的利器。
- tcpdump 仅支持命令行格式使用，常用在 Linux 服务器中抓取和分析网络包。
- Wireshark 除了可以抓包外，还提供了可视化分析网络包的图形页面。
这两者实际上是搭配使用的，先用 tcpdump 命令在 Linux 服务器上抓包，接着把抓包的文件拖出到 Windows 电脑后，用 Wireshark 可视化分析。

## tcpdump
tcpdump 是 Linux 系统中强大的网络抓包工具，它使用 libpcap 库来抓取网络包，这个库在几乎所有的 Linux/Unix 中都有。

### 基本用法
tcpdump 的基本用法如下：
```
tcpdump [选项] [过滤表达式]
```
- 选项用来配置 tcpdump 的功能，比如指定抓取的网络接口、是否解析 DNS 等。
- 过滤表达式用来过滤网络包，只抓取感兴趣的网络包。

### 常用选项与过滤
![tcmp选项](https://cdn.jsdelivr.net/gh/zysok2023/cloudImg/blogs/picture/tcmp选项.webp)
![tcmp过滤](https://cdn.jsdelivr.net/gh/zysok2023/cloudImg/blogs/picture/tcmp过滤.webp)

### 抓包实例
```tcpdump -i eth0 icmp and host www.baidu.com -w file.pcap
```
![ping-cap](https://cdn.jsdelivr.net/gh/zysok2023/cloudImg/blogs/picture/ping-cap.png)
这条命令表示抓取 eth0 网络接口上的所有网络包，并把抓取结果保存在 file.pcap 文件中。
在工作中 tcpdump 只是用来抓取数据包，不用来分析数据包，而是把 tcpdump 抓取的数据包保存成 pcap 后缀的文件，接着用 Wireshark 工具进行数据包分析。
![wireshark解析](https://cdn.jsdelivr.net/gh/zysok2023/cloudImg/blogs/picture/wireshark解析.png)

- Frame：物理层数据帧的情况；
- Ethernet II：数据链路层以太网帧头部的信息；
- Internet Protocol Version 4：网络层数据包头部信息；
- Transmission Control Protocol：传输层的数据段头部信息。

